---
title: Linux CPU 性能： 平均负载
date: 2020-10-02 22:30:50
description: Linux CPU 平均负载

categories:
 - Linux
tags: 
- Linux
---


### 平均负载

- 平均负载是指单位时间内，系统处于**可运行状态**和**不可中断状态**的平均进程数，也就是平均活跃进程数，它和 CPU 使用率并没有直接关系

#### 可运行状态进程

- 指正在使用 CPU 或者正在等待 CPU 的进程，也就是我们常用 ps 命令看到的，处于 R 状态（Running 或 Runnable）的进程


#### 不可中断进程

- 正处于内核态关键流程中的进程，并且这些流程是不可打断的，比如最常见的是等待硬件设备的 I/O 响应，也就是我们在 ps 命令中看到的 D 状态（Uninterruptible Sleep，也称为 Disk Sleep）的进程。


- 与PS有关的命令：[LINK](https://www.cnblogs.com/peida/archive/2012/12/19/2824418.html)


- 比如，当一个进程向磁盘读写数据时，为了保证数据的一致性，在得到磁盘回复前，它是不能被其他进程或者中断打断的，这个时候的进程就处于不可中断状态。如果此时的进程被打断了，就容易出现磁盘数据与进程数据不一致的问题。


### 平均负载多少时合理

- 首先，系统CPU个数：`grep 'model name' /proc/cpuinfo | wc -l`

- 可以使用`top`或者`uptime`来了解负载， 最后的三个数组表示过去 1 分钟、5 分钟、15 分钟的平均负载（Load Average），可以通过这三个数组表示平均负载的趋势


- 一般给定值是 `70%`


### 平均负载与CPU使用率

- CPU 密集型进程，使用大量 CPU 会导致平均负载升高，此时这两者是一致的；
- I/O 密集型进程，等待 I/O 也会导致平均负载升高，但 CPU 使用率不一定很高；
- 大量等待 CPU 的进程调度也会导致平均负载升高，此时的 CPU 使用率也会比较高


### 案例

TODO

#### CPU密集型进程

